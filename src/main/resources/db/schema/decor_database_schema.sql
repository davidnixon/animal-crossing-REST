-- Drop tables if they exist
DROP TABLE IF EXISTS DECOR_VARIANTS;
DROP TABLE IF EXISTS DECOR_NAMES;
DROP TABLE IF EXISTS DECOR;

CREATE TABLE DECOR
(
    ID                    INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    KIND                  VARCHAR(32),
    BODY_TITLE            VARCHAR(32),
    PATTERN_TITLE         VARCHAR(32),
    IS_DIY                BOOLEAN,
    CAN_CUSTOMIZE_BODY    BOOLEAN,
    CAN_CUSTOMIZE_PATTERN BOOLEAN,
    KIT_COST              INTEGER,
    SIZE                  VARCHAR(16),
    SOURCE                VARCHAR(64),
    SOURCE_DETAIL         VARCHAR(128),
    SPEAKER_TYPE          VARCHAR(16) DEFAULT NULL,
    VERSION               VARCHAR(16),
    HHA_CONCEPT_1         VARCHAR(16),
    HHA_CONCEPT_2         VARCHAR(16),
    HHA_SERIES            VARCHAR(32),
    HHA_SET               VARCHAR(32),
    IS_INTERACTIVE        BOOLEAN,
    TAG                   VARCHAR(32),
    IS_OUTDOOR            BOOLEAN,
    LIGHTING_TYPE         VARCHAR(16),
    IS_DOOR_DECO          BOOLEAN     DEFAULT FALSE,
    IS_CATALOG            BOOLEAN,
    INTERNAL_ID           INTEGER,
    BUY_PRICE             INTEGER,
    SELL_PRICE            INTEGER,
    CATEGORY              VARCHAR(32) NOT NULL -- wall-mounted, housewares, or misc
);

-- Decor variants table
CREATE TABLE DECOR_VARIANTS
(
    ID         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DECOR_ID   INTEGER NOT NULL,
    VARIANT    VARCHAR(32),
    COLOR_1    VARCHAR(16),
    COLOR_2    VARCHAR(16),
    FILE_NAME  VARCHAR(64),
    VARIANT_ID VARCHAR(16),
    IMAGE_URI  VARCHAR(128),
    PATTERN    VARCHAR(32),
    FOREIGN KEY (DECOR_ID) REFERENCES DECOR (ID) ON DELETE CASCADE
);

-- Localized names
CREATE TABLE DECOR_NAMES
(
    ID       INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DECOR_ID INTEGER      NOT NULL,
    LOCALE   VARCHAR(32)  NOT NULL,
    NAME     VARCHAR(128) NOT NULL,
    FOREIGN KEY (DECOR_ID) REFERENCES DECOR (ID) ON DELETE CASCADE
);

CREATE INDEX idx_decor_category ON DECOR (CATEGORY);
CREATE INDEX idx_decor_kind ON DECOR (KIND);
